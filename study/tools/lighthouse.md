---
description: 구글의 오픈소스 도구 중 하나인 lighthouse 를 이용해 화면에서 발생하는 랜더링 속도를 저하하는 요소들을 개선한 사례 입니다.
---

# Lighthouse  를 이용한 화면 응답 속도 개선

## 들어가기 앞서 작성하게 된 사유

회사에 입사하여 첫 업무가 특정 페이지에서 발생하는 랜더링 및 지연이 일으키는 부분을 개선하라는 지시가 내려왔습니다.&#x20;

서버 api 응답이 지연 되면 그 부분을 집중적으로 파고 들면 되지만,  Spring mvc 로 구성된 이 플랫폼은 뷰 영역까지 체크를 해야했었습니다. 프론트에 대한 지식이 미천하기 때문에 아는 프론트 지인에게 프론트 페이지 랜더링 지연을 일으키는 문제를 분석하는 방법을 물어봤을때 추천 받았던게 바로 LightHouse 였습니다.

해당 도구를 통해 랜더링 지연 되는 영역을 분석하고, 해결하는 과정을 기억하기 위해 이 포스트를 작성하게 되었습니다.

## 라이트하우스란 무엇인가 <a href="#undefined" id="undefined"></a>

### 소개 <a href="#undefined" id="undefined"></a>

**Google Lighthouse**는 웹페이지의 품질을 개선하는 데 도움이 되는 **오픈소스 자동화 도구**입니다. 구글에서 개발한 이 도구는 공개 웹페이지나 인증이 필요한 모든 웹페이지에서 실행할 수 있으며, 웹사이트의 성능, 접근성, SEO 등에 대한 종합적인 감사 기능을 제공합니다.



### 주요 측정 지표 <a href="#undefined" id="undefined"></a>

### Core Web Vitals

라이트하우스는 Google이 정의한 **Core Web Vitals** 지표들을 중심으로 성능을 평가합니다:

| 지표                                 | 설명                                                | 기준                                        |
| ---------------------------------- | ------------------------------------------------- | ----------------------------------------- |
| **FCP (First Contentful Paint)**   | 사용자가 페이지로 이동한 후 브라우저에서 첫번째 DOM 콘텐츠를 렌더링하는데 걸리는 시간 | 0-1.8s: 좋음, 1.8-3.0s: 개선 필요, 3.0s+: 나쁨    |
| **LCP (Largest Contentful Paint)** | 표시 영역에 표시되는 가장 큰 이미지 또는 텍스트 블록 렌더링 시간             | 0-2.5s: 좋음, 2.5-4.0s: 개선 필요, 4.0s+: 나쁨    |
| **SI (Speed Index)**               | 페이지 로드 중 콘텐츠가 시각적으로 표시되는 속도를 측정                   | 0-3.4s: 좋음, 3.4-5.8s: 개선 필요, 5.8s+: 나쁨    |
| **TBT (Total Blocking Time)**      | 사용자 입력에 응답하지 못하도록 차단된 시간                          | 0-200ms: 좋음, 200-600ms: 개선 필요, 600ms+: 나쁨 |

### 라이트하우스만의 추가 지표

Core Web Vitals 외에도 라이트하우스는 다음과 같은 추가 지표들을 제공합니다:

* **TTI (Time to Interactive)**: 페이지가 완전히 상호작용 가능한 상태가 되는 시간
* **CLS (Cumulative Layout Shift)**: 시각적 안정성을 측정하는 지표

### 지표 활용 방향

#### LCP , FCP 는 우선순위에서 뒤처졌습니다.

사실 저희 서비스에서 성능 측정을 위한 베이스 데이터가 많든 적든 랜더링 하여 보여줬을때 FCP, LCP 는 일정한 수치를 넘어가지 않았습니다. 즉 저희의 첫 content 가 랜더링 되는 부분과 large content 은 저희 서비스 랜더링 속도에 큰 영향을 주지 않았습니다.

#### TBT , Speed Index

앞서 지표중 TBT 는 사용자 입력이 응답하지 못하도록 차단된 시간의 지표였습니다. row 데이터가 많아지면 많아질수록 점수에 영향이 직접적이었습니다. 많은 row 데이터를 chart, grid 형태로 랜더링 하는 과정에  \
FCP 와 상호작용 시간 사이에 모든 장기 작업(50ms 이상)의 차단 부분(Grid, Chart 등)을 더하여 계산했습니다.

<figure><img src="../../.gitbook/assets/image (39).png" alt=""><figcaption></figcaption></figure>

SI 도 같은 맥락으로 row 데이터를 기반으로 chart , grid content 로 노출이 되기 까지 많은 시간이 소요가 되었습니다.

이 두 지표가 서비스에 측정에 가장 직관적으로 확인이 가능한 부분이여서 이 두 지표를 개선하는 방향으로 성능 개선 작업을 진행하였습니다.

아래는 성능 개선 작업 이전에 성능 점수를 row 데이터를 기준으로 측정한 결과값 입니다. 어느 특정 갯수 이상 부터는 아예 측정 불가한 지표들이 일부 존재하여 평균 10점대의 성능점수가 나오는것으로 확인 되었습니다.

<figure><img src="../../.gitbook/assets/image (41).png" alt=""><figcaption></figcaption></figure>

다음은 각각 content 에 따른 점수 구간을 테이블 표로 작성한것 입니다. 테이블 보다 chart 를 그릴때 랜더링 속도가 현저히 저하되는 현상을 확인할수 있었습니다.

<figure><img src="../../.gitbook/assets/image (42).png" alt=""><figcaption></figcaption></figure>



